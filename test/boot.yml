

- hosts: test
  gather_facts: false
  vars_files:
    - ~/.config/base-docker/settings.yml
  tasks:
    - name: set hostname
      command:
        cmd: "hostnamectl set-hostname {{ hosts.test_host }}"
      
- hosts: test
  gather_facts: true
  vars_files:
    - ~/.config/base-docker/settings.yml
  tasks:
    - name: read encrypted values
      include_vars:
        file: "~/.config/base-docker/secrets.yml"
        name: secrets_vals
    - name: Join Tailscale network
      ansible.builtin.include_role:
        name: artis3n.tailscale.machine
      vars:
        tailscale_authkey: "{{ secrets_vals.ts_authkey }}" 
    - name: output ip
      debug:
        msg: "Tailscale IP: {{ tailscale_node_ipv4 }}"    


       

