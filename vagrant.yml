---

- hosts: node
  vars:
    ansible_python_interpreter: /usr/bin/python3
    ansible_become: true
  gather_facts: yes
  roles:
    - geerlingguy.docker
  tasks:
    - name: adding existing user '{{ user }}' to group sudo
      user:
        name: vagrant
        groups: docker
        append: yes
    - name: project(s) dir
      file:
        path: /home/vagrant/code
        state: directory
        owner: vagrant
        group: vagrant
    - name: working dir
      file:
        path: /home/vagrant/files
        state: directory
        owner: vagrant
        group: vagrant
    - name: install virtualenv
      ansible.builtin.apt:
        name: virtualenv
        state: present

- hosts: node
  vars:
    ansible_python_interpreter: /usr/bin/python3
  gather_facts: false
  tasks:
    - name: clear folder
      ansible.builtin.file:
        path: ~/python
        state: absent
    - name: setup virtualenv
      shell:
        cmd: virtualenv ~/python
...
